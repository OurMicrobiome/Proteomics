---
title: "lipids plotted"
author: "Hanna Choi"
date: "5/3/2020"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```
```{r}
POS <- read.csv("Blanchard_Lipid_POS.csv", header=TRUE)
NEG <- read.csv("Blanchard_Lipid_NEG.csv", header=TRUE)
### Cleaned names
names(POS) <- gsub(x = names(POS), pattern = "_POS", replacement = "_")  
names(NEG) <- gsub(x=names(POS), pattern="_NEG", replacement="_")
### add Column with POS or NEG
POS$charge <- c("POS","POS","POS","POS","POS","POS","POS","POS","POS","POS","POS","POS","POS","POS","POS","POS","POS","POS","POS","POS","POS","POS","POS","POS","POS","POS","POS","POS","POS","POS","POS","POS","POS","POS","POS","POS","POS","POS","POS","POS","POS","POS","POS","POS","POS","POS","POS","POS","POS","POS","POS","POS","POS","POS","POS","POS","POS","POS","POS","POS","POS","POS","POS","POS","POS","POS","POS","POS","POS","POS","POS","POS","POS","POS","POS","POS","POS","POS","POS","POS","POS","POS","POS","POS","POS","POS","POS","POS","POS","POS","POS","POS","POS","POS","POS","POS","POS","POS","POS","POS","POS","POS","POS","POS","POS","POS","POS","POS","POS","POS","POS","POS","POS","POS","POS","POS","POS")
NEG$charge <- c("NEG","NEG","NEG","NEG","NEG","NEG","NEG","NEG","NEG","NEG","NEG","NEG","NEG","NEG","NEG","NEG","NEG","NEG","NEG","NEG","NEG","NEG","NEG","NEG","NEG","NEG","NEG","NEG","NEG","NEG","NEG","NEG","NEG","NEG","NEG","NEG","NEG","NEG","NEG","NEG","NEG","NEG","NEG","NEG","NEG","NEG","NEG","NEG","NEG","NEG","NEG","NEG","NEG","NEG","NEG","NEG","NEG","NEG","NEG","NEG","NEG","NEG","NEG","NEG","NEG","NEG","NEG","NEG","NEG","NEG","NEG","NEG","NEG","NEG","NEG")
combined <- merge(POS, NEG, by=c("row.identity", "Blanch_Nat_Lip_C_12_AB_M_17_", "Blanch_Nat_Lip_C_19_AB_O_26_", "Blanch_Nat_Lip_H_17_AB_O_22_", "Blanch_Nat_Lip_H_30_AB_M_11_", "Blanch_Nat_Lip_C_19_AB_M_16_", "Blanch_Nat_Lip_C_27_AB_O_21_", "Blanch_Nat_Lip_C_12_AB_O_25_", "Blanch_Nat_Lip_C_14_AB_M_27_", "Blanch_Nat_Lip_C_14_AB_O_09_", "Blanch_Nat_Lip_C_30_AB_M_14_", "Blanch_Nat_Lip_C_34_AB_O_10_", "Blanch_Nat_Lip_C_4_AB_M_08_",  "Blanch_Nat_Lip_C_4_AB_O_04_",  "Blanch_Nat_Lip_H_28_AB_M_03_", "Blanch_Nat_Lip_H_11_AB_M_13_", "Blanch_Nat_Lip_H_17_AB_M_18_", "Blanch_Nat_Lip_H_26_AB_M_12_", "Blanch_Nat_Lip_C_7_AB_M_07_",  "Blanch_Nat_Lip_H_11_AB_O_24_", "Blanch_Nat_Lip_H_2B_M_02_",   "Blanch_Nat_Lip_H_2_AB_M_23_",  "Blanch_Nat_Lip_H_32_AB_M_20_", "Blanch_Nat_Lip_H_2_AB_O_15_",  "Blanch_Nat_Lip_H_32_AB_O_19_", "Blanch_Nat_Lip_H_34_AB_M_01_", "Blanch_Nat_Lip_H_4_AB_O_06_",  "Blanch_Nat_Lip_H_4_AB_M_05_",  "charge"))
combined <- rbind(POS, NEG)
names(combined) <- gsub(x = names(POS), pattern = "Blanch_Nat_Lip_", replacement = "")  
rc <- combined[,c(-1,-2)]
library(tidyr)
n <- gather(rc, key='plot', value=frequency, "C_12_AB_M_17_", "C_19_AB_M_16_", "C_14_AB_M_27_", "C_30_AB_M_14_", "C_4_AB_M_08_", "C_7_AB_M_07_"  ,"H_30_AB_M_11_"  ,"H_28_AB_M_03_","H_11_AB_M_13_", "H_17_AB_M_18_"  ,   "H_26_AB_M_12_"   ,  "H_2B_M_02_"    ,  "H_2_AB_M_23_", "H_32_AB_M_20_"   ,  "H_34_AB_M_01_"    , "H_4_AB_M_05_"   ,   "C_19_AB_O_26_"  , "C_27_AB_O_21_"    , "C_12_AB_O_25_"     ,"C_14_AB_O_09_"   ,  "C_34_AB_O_10_" , "C_4_AB_O_04_", "H_17_AB_O_22_",  "H_11_AB_O_24_"    , "H_2_AB_O_15_","H_32_AB_O_19_", "H_4_AB_O_06_")
n <- n %>%
  separate(plot, c("plot", "plot_number", "AB", "soil_type", "type_number"), "_")
n$AB <- NULL
n$lipid <- n$row.identity
n$lipid <- gsub("\\(.*","",n$lipid)
n$soil_type <- gsub("02", "M", n$soil_type)
```
```{r}
splitn <- split(n, n$lipid)
# https://stackoverflow.com/questions/34174799/r-get-subset-from-data-frame-filtering-by-year-date-value
```
```{r}
library(caret)
# https://machinelearningmastery.com/pre-process-your-dataset-in-r/
for (i in 1:13){
  r <- splitn[[i]]
  preproc_i <- preProcess(r, method=c("center", "scale"))
  rx <- predict(preproc_i, r)
  splitn[[i]]$stdized <- rx$frequency
}
```

### heatmap
```{r}
plotlist <- list()
library(ggplot2)
for (i in 1:13){
  plotlist[[i]] <- ggplot(splitn[[i]], aes(x=plot, y=stdized, group=plot)) + geom_boxplot(aes(fill=plot)) + ggtitle(splitn[[i]][1,8])
}
```
### Figure 
```{r fig.height=9}
##### I'm not done yet
library(ggpubr)
figure <- ggarrange(plotlist[[1]], plotlist[[2]], plotlist[[3]], ncol=3)
figure
```


